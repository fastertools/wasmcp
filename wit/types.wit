package fastertools:mcp@0.1.7;

/// Core type definitions for the Model Context Protocol
/// These types are used across all MCP interfaces

interface types {
    /// Role in a conversation
    enum role {
        user,
        assistant,
    }

    /// Metadata fields as arbitrary JSON object
    /// Represents key-value pairs where values can be any JSON type
    /// This allows arbitrary nested structures including objects and arrays
    type meta-fields = json-object;
    
    /// Annotations provide hints to clients about how to handle data
    record annotations {
        /// Who this data is intended for
        audience: option<list<role>>,
        /// Priority from 0.0 (least) to 1.0 (most important)
        /// Implementations SHOULD validate this is within [0.0, 1.0] range
        priority: option<f64>,
        /// ISO 8601 timestamp of last modification
        /// Format: YYYY-MM-DDTHH:mm:ss[.sss]Z or Â±HH:MM offset
        last-modified: option<string>,
    }

    /// Base metadata pattern used throughout the protocol
    record base-metadata {
        /// Programmatic identifier
        name: string,
        /// Human-readable display name
        title: option<string>,
    }

    /// Content block types that can be included in messages
    variant content-block {
        text(text-content),
        image(image-content),
        audio(audio-content),
        resource-link(resource-link),
        embedded-resource(embedded-resource),
    }

    /// Text content with optional annotations
    record text-content {
        text: string,
        annotations: option<annotations>,
        meta: option<meta-fields>,
    }

    /// Image content as binary data
    record image-content {
        /// Base64-encoded image data
        data: list<u8>,
        /// MIME type (e.g., "image/png", "image/jpeg")
        mime-type: string,
        annotations: option<annotations>,
        meta: option<meta-fields>,
    }

    /// Audio content as binary data
    record audio-content {
        /// Base64-encoded audio data
        data: list<u8>,
        /// MIME type (e.g., "audio/wav", "audio/mp3")
        mime-type: string,
        annotations: option<annotations>,
        meta: option<meta-fields>,
    }

    /// Reference to a resource that the server can read
    /// Resource links included in prompts or tool results may not appear in resources/list
    record resource-link {
        /// URI of the resource
        uri: string,
        /// Programmatic identifier for the resource
        name: string,
        /// Human-readable display title (preferred for UI display)
        title: option<string>,
        /// Description of what this resource represents
        description: option<string>,
        /// MIME type of the resource, if known
        mime-type: option<string>,
        /// Size in bytes (before encoding), if known
        size: option<u64>,
        /// Client hints for handling
        annotations: option<annotations>,
        /// Extension metadata
        meta: option<meta-fields>,
    }

    /// Embedded resource content
    /// The contents of a resource, embedded into a prompt or tool call result
    record embedded-resource {
        /// The actual resource contents (text or binary)
        resource: resource-contents,
        /// Client hints for handling
        annotations: option<annotations>,
        /// Extension metadata
        meta: option<meta-fields>,
    }

    /// Resource contents can be either text or binary
    variant resource-contents {
        text(text-resource-contents),
        blob(blob-resource-contents),
    }

    record text-resource-contents {
        uri: string,
        mime-type: option<string>,
        text: string,
        meta: option<meta-fields>,
    }

    record blob-resource-contents {
        uri: string,
        mime-type: option<string>,
        /// Binary data
        blob: list<u8>,
        meta: option<meta-fields>,
    }

    /// Structured JSON value representation
    /// This provides type-safe JSON handling within the component model
    variant json-value {
        /// JSON null value
        null,
        /// JSON boolean value
        bool(bool),
        /// JSON number value (supports both integers and floating point)
        number(f64),
        /// JSON string value
        string(string),
        /// JSON array value
        array(list<json-value>),
        /// JSON object value as key-value pairs
        object(list<tuple<string, json-value>>),
    }
    
    /// JSON Schema representation
    /// Kept as a string since JSON Schema is complex
    /// and typically validated by specialized libraries
    type json-schema = string;
    
    /// JSON object type for convenience
    /// Represents a JSON object as key-value pairs
    type json-object = list<tuple<string, json-value>>;

    /// Standard JSON-RPC and MCP error codes
    variant error-code {
        /// JSON-RPC standard errors
        parse-error,           // -32700
        invalid-request,       // -32600
        method-not-found,      // -32601
        invalid-params,        // -32602
        internal-error,        // -32603
        /// MCP-specific errors
        resource-not-found,
        tool-not-found,
        prompt-not-found,
        unauthorized,
        rate-limited,
        timeout,
        cancelled,
        /// Custom error with specific code
        custom-code(s32),
    }

    /// Standard error structure
    record mcp-error {
        code: error-code,
        message: string,
        /// Additional error context (JSON-encoded)
        data: option<string>,
    }

    /// Pagination cursor for list operations
    type cursor = string;

    /// Progress token for tracking long-running operations
    type progress-token = string;
    
    /// JSON-RPC request ID
    /// Can be either a string or number in JSON-RPC
    variant request-id {
        string(string),
        number(s64),
    }
    
    /// Message role for LLM interactions
    enum message-role {
        user,
        assistant,
        system,
    }
    
    /// Model selection preferences for LLM sampling
    record model-preferences {
        /// Hints for model selection
        hints: option<list<model-hint>>,
        /// Priority for cost optimization (0.0-1.0)
        cost-priority: option<f64>,
        /// Priority for speed (0.0-1.0)
        speed-priority: option<f64>,
        /// Priority for intelligence/capability (0.0-1.0)
        intelligence-priority: option<f64>,
    }
    
    /// Hint for model selection
    record model-hint {
        /// Name pattern to match (e.g., "claude", "gpt-4")
        name: option<string>,
    }
    
    /// Resource template with URI template support (RFC 6570)
    record resource-template {
        /// URI template that can be expanded with variables
        uri-template: string,
        /// Identifier for the template
        name: string,
        /// Human-readable description
        description: option<string>,
        /// Expected MIME type of resources
        mime-type: option<string>,
    }
}
